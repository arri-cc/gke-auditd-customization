apiVersion: v1
kind: ConfigMap
metadata:
  name: auditd-rules
  namespace: auditd-logging
  labels:
    app: auditd-logs
data:
  audit.rules: |
    ## This file is automatically generated from /etc/audit/rules.d
    -D

    ## larger buffer
    -b 8192
    ## syslog failure mode
    -f 1
    ## ignore syntax errors
    -i
    ##-a never,exclude -F msgtype!=CONFIG_CHANGE -F msgtype!=AVC -F msgtype!=USER_AVC -F msgtype!=SECCOMP -F msgtype!=SYSCALL -F msgtype!=PATH -F msgtype!=TTY -F msgtype!=USER_ACCT -F msgtype!=USER_START -F msgtype!=USER_END
    -w /sbin/auditctl -p x -k test_audit_exec
    -w /bin/ls -p x -k test_audit_exec
    -w /usr/bin/curl -p x -k test_audit_exec
    -w /etc/audit/ -k test_audit_folders
    -w /etc/audit/test.audit.file -p wa -k test_audit_files
